contains all the logics of the function used in routes